
<h1><%= @page_title %></h1>

<%
-%>

<%= link_to 'Filter Rows/Columns', :action => 'choose_to_list' %>
&nbsp;&nbsp;
<%= link_to 'Attribute Legend', :action => 'show_attribute_legend' %>

<table id="table_players">
  <tr>
    <% @columns.each do |column| -%>
      <th><%= h column_index(column) %></th>
    <% end -%>

    <% player_attribute_abbrs.each do |abbr| -%>
      <th><%= abbr -%></th>
    <% end -%>
  </tr>

  <% @players.each do |player| -%>
    <tr class="<%= cycle('tableRow0', 'tableRow1') %>">
      <% @columns.each do |column| -%>
        <td align="<%= column_align(column) %>">
          <% case column.name
             when 'name' -%>
            <%= "<b>#{player.name}</b>" %>
          <% when 'position_id' -%>
            <%= "<b>#{player.position.name}</b> #{player.positions.map(&:name).join(' ')}" %>
          <% when 'skill_move' -%>
            <%= '★' * player.skill_move %>
          <% when 'is_right_dominant' -%>
            <%= player.is_right_dominant ? 'R' : 'L' %>
          <% when 'both_feet_level' -%>
            <%= '☆' * player.both_feet_level %>
          <% when 'nation_id' -%>
            <%= player.nation.name -%>
          <% else -%>
            <%= h player.send(:attributes)[column.name] %>
          <% end -%>
        </td>
      <% end -%>

      <% attrs = player.player_attribute
         PlayerAttribute.content_columns.each do |column| -%>
        <td align="right"><%= attrs.send(:attributes)[column.name] %></td>
      <% end -%>
    </tr>
  <% end -%>
</table>


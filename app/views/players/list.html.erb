
<h1><%= @page_title %></h1>

<%
  last_column = @columns[-1]
-%>

<%= link_to 'Filter Rows/Columns', :action => 'choose_to_list' %>
<%= nbsp(2) %>
<%= link_to 'Attribute Legend', :action => 'show_attribute_legend' %>
<%= nbsp(4) %>
<%= link_to 'Depth Chart', :action => 'depth_chart' %>
<%= nbsp(2) %>
<%= link_to 'Roster Chart', :action => 'roster_chart' %>

<table id="table_players">
  <tr>
    <th><%= nbsp %></th>

    <% @columns.each do |column| -%>
      <th><%= h column_index(column) %></th>
    <% end -%>

    <% @attribute_columns.each do |column| -%>
      <th><%= PlayerAttribute.abbr(column.name) %></th>
    <% end -%>
  </tr>

  <% @players.each do |player| -%>
    <tr class="<%= cycle('tableRow0', 'tableRow1') %>">
      <td><%= link_to '>', player %></td>

      <% @columns.each do |column| -%>
        <% clazz = column == last_column ? 'rightmost_of_players' : '' -%>
        <td align="<%= column_align(column) %>" class="<%= clazz %>">
          <%= render :partial => 'property_display', :locals => {:column => column, :player => player} %>
        </td>
      <% end -%>

      <% is_leftmost = true
         attrs = player.player_attribute -%>
      <% @attribute_columns.each do |column| -%>
        <% clazz = is_leftmost ? 'leftmost_of_attributes' : ''
           is_leftmost = false -%>
        <td align="right" class="<%= clazz %>"><%= attrs.send(:attributes)[column.name] %></td>
      <% end -%>
    </tr>
  <% end -%>
</table>

